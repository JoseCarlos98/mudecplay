<div class="card-content shadow-md">
  <app-module-header title="Gastos" [config]="headerConfig" (action)="onHeaderAction($event)">
  </app-module-header>

  <form [formGroup]="formFilters">
    <div class="c-filters grid grid-cols-2 sm:grid-cols-5 lg:grid-cols-6">
      <app-input-date 
        formControlName="dateRange" 
        label="Rango de fecha" 
        mode="range">
      </app-input-date>

      <app-autocomplete-multiple 
        formControlName="suppliersIds" 
        label="Proveedores" 
        [remote]="true"
        catalogType="supplier">
      </app-autocomplete-multiple>

      <app-autocomplete-multiple 
        formControlName="projectIds" 
        label="Proyectos"
        [remote]="true"
        catalogType="project">
      </app-autocomplete-multiple>

      <div class="c-input">
        <p>Estado de asignaci√≥n</p>
        <mat-form-field appearance="outline" class="w-100"
          [ngClass]="{ 'padding-selection-select' : formFilters.get('status_id')?.value  }">
          <mat-select #statusSel="matSelect" formControlName="status_id">
            <mat-option value="">Todos</mat-option>
            @for (data of catalogStatusExpense; track data.id) {
            <mat-option [value]="data.id">{{ data.name }}</mat-option>
            }
          </mat-select>
          @if (formFilters.get('status_id')?.value) {
          <button type="button" matSuffix mat-icon-button [disableRipple]="true"
            (mousedown)="$event.preventDefault(); $event.stopPropagation()"
            (click)="$event.stopPropagation(); clearInput('statusId'); statusSel.close()" aria-label="Limpiar estado">
            <mat-icon matSuffix class="cursor-pointer color-third">close</mat-icon>
          </button>
          }
        </mat-form-field>
      </div>

      <app-input-field 
        formControlName="concept" 
        label="Concepto" 
        type="text">
      </app-input-field>

      <app-sections-btns 
        [hasActiveFilters]="hasActiveFilters" 
        (clearAllAndSearch)="clearAllAndSearch()" 
        (searchWithFilters)="searchWithFilters()">
      </app-sections-btns>
    </div>
  </form>
</div>

@if (expensesTableData?.data) {
<div class="c-module-table">
  <app-data-table [data]="expensesTableData.data" [columnsConfig]="columnsConfig" [displayedColumns]="displayedColumns"
    (edit)="onEdit($event)" (delete)="onDelete($event)">
  </app-data-table>

  <mat-paginator [length]="expensesTableData.meta.total" [pageSize]="filters.limit" [pageIndex]="filters.page - 1"
    [pageSizeOptions]="[5, 10, 25, 50]" (page)="onPageChange($event)" showFirstLastButtons>
  </mat-paginator>
</div>
}