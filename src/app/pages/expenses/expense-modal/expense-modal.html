<div class="c-modal">
    <app-module-header title="Registrar Gasto" [config]="headerConfig" (action)="closeModal()">
    </app-module-header>

    <form [formGroup]="form" (ngSubmit)="save()" id="form" class="c-form">

        <div class="grid md:grid-cols-2 sm:grid-cols-1 gap-5">

            <!-- Concepto -->
            <div class="md:col-span-2">
                <div class="c-input">
                    <p class="label">Concepto <span class="required">*</span></p>
                    <mat-form-field appearance="outline" class="w-100">
                        <input matInput placeholder="Ej. Compra de materiales" formControlName="concept" />
                        @if (form.get('concept')?.touched && form.get('concept')?.invalid) {
                        <mat-error>El concepto es obligatorio.</mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>

            <!-- Fecha -->
            <div class="md:col-span-1">
                <div class="c-input">
                    <p class="label">Fecha <span class="required">*</span></p>
                    <mat-form-field appearance="outline" class="w-100">
                        <input matInput type="date" formControlName="date" />
                        @if (form.get('date')?.touched && form.get('date')?.invalid) {
                        <mat-error>Selecciona una fecha.</mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>

            <!-- Monto -->
            <div class="md:col-span-1">
                <div class="c-input">
                    <p class="label">Monto <span class="required">*</span></p>
                    <mat-form-field appearance="outline" class="w-100">
                        <input matInput type="number" step="0.01" placeholder="Ej. 1250.50" formControlName="amount" />
                        @if (form.get('amount')?.touched && form.get('amount')?.invalid) {
                        <mat-error>El monto es obligatorio.</mat-error>
                        }
                    </mat-form-field>
                </div>
            </div>

            <!-- Proveedor -->
            <div class="md:col-span-1">
                <app-autocomplete label="Proveedor" placeholder="Seleccionar proveedor" catalogType="supplier"
                    [remote]="true" (optionSelected)="form.patchValue({ supplier_id: $event.id })">
                </app-autocomplete>

                <!-- @if (form.get('supplier_id')?.touched && form.get('supplier_id')?.invalid) {
                <mat-error>El proveedor es obligatorio.</mat-error>
                } -->
            </div>

            <!-- Proyecto -->
            <div class="md:col-span-1">
                <div class="c-input">
                    <!-- <p class="label">Proyecto</p>
                    <mat-form-field appearance="outline" class="w-100">
                        <input matInput type="text" placeholder="Seleccionar proyecto" formControlName="project_id"
                            [matAutocomplete]="autoProject" />

                        <mat-autocomplete #autoProject="matAutocomplete" [displayWith]="displayCatalog">
                            @for (project of filteredProjects$ | async; track project.id) {
                            <mat-option [value]="project.id">
                                {{ project.name }}
                            </mat-option>
                            }
                        </mat-autocomplete>
                    </mat-form-field> -->
                </div>
            </div>


            <!-- Proyecto (autocomplete despuÃ©s) -->
            <!-- <div class="md:col-span-1">
                <div class="c-input">
                    <p class="label">Proyecto</p>
                    <mat-form-field appearance="outline" class="w-100">
                        <input matInput placeholder="Seleccionar proyecto" formControlName="project_id" />
                    </mat-form-field>
                </div>
            </div> -->
        </div>
    </form>

    <!-- Botones -->
    <div class="c-modal-actions">
        <button mat-stroked-button type="button" (click)="closeModal()" class="btn-cancel">
            Cancelar
        </button>

        <button [ngClass]="{'not-cursor-pointer': !form.valid}" mat-flat-button type="submit" form="form"
            class="btn-primary">
            Guardar
        </button>
    </div>
</div>